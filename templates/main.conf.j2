# {{ ansible_managed }}
# This is the main apache configuration file. It is generated by the aspects_apache24 role.
{% if

         (inprocess_gen_conf_result is defined and inprocess_gen_conf_result.changed)
         or (inprocess_rm_gen_conf_result is defined and inprocess_rm_gen_conf_result.changed)
         or (inprocess_mod_conf_result is defined and inprocess_mod_conf_result.changed)
         or (inprocess_rm_mod_conf_result is defined and inprocess_rm_mod_conf_result.changed)
         or (inprocess_vh_conf_result is defined and inprocess_vh_conf_result.changed)
         or (inprocess_rm_vh_conf_result is defined and inprocess_rm_vh_conf_result.changed)

%}
# Set a timestamp so the file always changes, thus triggering a validation.
# {{ ansible_date_time.epoch }}
{% endif %}
ServerRoot {{ aspects_apache24_configuration_root }}

{% if ansible_os_family == "RedHat" %}
PidFile /run/httpd/httpd.pid
{% elif ansible_os_family == "Debian" %}
PidFile /run/apache2/apache2.pid
{% endif %}

{{ aspects_apache24_base_modules }}

# Server user and group
{% if ansible_os_family == "RedHat" %}
User {{ aspects_apache24_process_user|default('apache') }}
Group {{ aspects_apache24_process_group|default('apache') }}
{% elif ansible_os_family == "Debian" %}
User {{ aspects_apache24_process_user|default('www-data') }}
Group {{ aspects_apache24_process_group|default('www-data') }}
{% endif %}

ServerName {{ ansible_fqdn }}

IncludeOptional {{ aspects_apache24_configuration_root }}/aspects.conf.d/*.conf
IncludeOptional {{ aspects_apache24_configuration_root }}/aspects.mods.d/*.conf
IncludeOptional {{ aspects_apache24_configuration_root }}/aspects.vhosts.d/*.conf
# vim: syntax=apache ts=2 sw=2 sts=2 sr noet